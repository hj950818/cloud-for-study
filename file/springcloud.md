# springcloud alibaba

## 微服务架构组成

- 服务的注册与发现
- 服务调用
- 服务熔断
- 负载均衡
- 服务降级
- 服务消息队列
- 配置中心管理
- 服务网管
- 服务监控
- 全链路追踪
- 服务自动化构建部署
- 服务定时任务调度操作

## 什么的微服务

springcloud=分布式微服务架构的一站式解决方案，是多种微服务架构落地技术的集合体，俗称微服务全家桶



## eureka

#### eurekaserver

实质：存key 服务名，取value调用服务地址

- 服务注册：讲服务注册信息注册到注册中心
- 服务发现：从注册中心获取服务信息



1. 先启动eureka注册中心
2. 启动服务提供者支付服务
3. 支付服务启动后会把自身信息（比如服务地址以别名的方式注册进eureka）
4. 消费者服务在需要调接口时，使用服务别名去注册中心获取实际的RPC远程调用地址
5. 消费者获得调用的地址后，底层实际是利用HttpClient技术实现远程调用
6. 消费者获取服务地址后会缓存到jvm内存中，默认每隔30S更新一次服务调用地址

#### 自我保护机制

##### 为什么会产生自我保护机制

为了防止EurekaClient可以正常运行，但是与EurekaServer网络不通情况下，EurekaServer不会立刻将EurekaClient剔除。

##### 什么是自我保护机制

默认情况下，如果eurekaServer在一定时间内没有接收到微服务实例的心跳，EurekaServer将会注销该实例（默认90秒），但是当网络分区故障发生（延时，卡顿，拥挤时），微服务与EurekaServer之间无法正常通信，以上行为可能变得非常微信了，因为微服务本身其实是健康的，此时不应该注销这个微服务。Eureka通过“自我保护机制”来解决这个问题----当EurekaServer节点在短时间内丢失过多客户端时（可能发生了网络分区故障），那么这个节点就会进入自我保护机制。
